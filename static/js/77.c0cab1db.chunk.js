"use strict";(self.webpackChunkadriancleung_app=self.webpackChunkadriancleung_app||[]).push([[77],{3708:function(e,n,r){r.d(n,{Gh:function(){return t},fs:function(){return a},M:function(){return u},LD:function(){return c},T5:function(){return s},c7:function(){return i}});var t=200,a="INVALID_TOKEN",u="VALID_TOKEN",c=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,s="https://api.adrianleung.dev",i="https://api.github.com"},4077:function(e,n,r){r.r(n),r.d(n,{default:function(){return k}});var t=r(5861),a=r(885),u=r(7757),c=r.n(u),s=r(2791),i=r(1223),o=r(513),l=r(9353),p=r(5731),f=r(3906),d=r(2184);function h(){return h=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},h.apply(this,arguments)}var m=(0,s.forwardRef)((function(e,n){return s.createElement(d.x,h({ref:n,viewBox:"0 0 24 24",a11yTitle:"UserAdmin"},e),s.createElement("path",{fill:"none",stroke:"#000",strokeWidth:"2",d:"M8 11A5 5 0 1 0 8 1a5 5 0 0 0 0 10zm5.023 2.023C11.772 11.76 10.013 11 8 11c-4 0-7 3-7 7v5h7m2-3.5a2.5 2.5 0 1 0 5.002-.002A2.5 2.5 0 0 0 10 19.5zM23 15l-3-3-6 6m3.5-3.5 3 3-3-3z"}))}));m.displayName="UserAdmin";var x=r(746),v=r(6871),w=r(3708),g=r(184),k=function(e){var n=(0,v.s0)(),r=(0,s.useState)(!1),u=(0,a.Z)(r,2),d=u[0],h=u[1],k=(0,s.useState)({email:"",password:""}),b=(0,a.Z)(k,2),j=b[0],y=b[1],Z=(0,s.useState)(!0),S=(0,a.Z)(Z,2),T=S[0],A=S[1];return(0,s.useEffect)((function(){var e=function(){var e=(0,t.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,x.wt)()===w.M&&h(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),d?(0,g.jsx)(v.Fg,{to:"/admin"}):(0,g.jsx)(i.x,{width:"100vw",height:"100vh",background:"dark-3",justify:"center",align:"center",children:(0,g.jsxs)(i.x,{width:"medium",height:"medium",background:"white",round:"medium",pad:"small",gap:"medium",align:"center",border:!0,children:[(0,g.jsx)(m,{size:"large"}),(0,g.jsx)(o.x,{children:"Welcome!"}),(0,g.jsx)(i.x,{height:"100%",children:(0,g.jsx)(l.l,{value:j,onSubmit:function(){(0,x.x4)(j.email,j.password).then((function(e){null!==e.accessToken?n("/admin"):A(!1)})).catch((function(){A(!1)}))},onChange:function(e){return y(e)},children:(0,g.jsxs)(i.x,{height:"100%",gap:"medium",children:[(0,g.jsxs)(i.x,{gap:"small",children:[(0,g.jsx)(p.W,{name:"email",placeholder:"Username",type:"email",autoComplete:"email"}),(0,g.jsx)(p.W,{name:"password",placeholder:"Password",type:"password",autoComplete:"password"})]}),(0,g.jsx)(o.x,{color:"red",hidden:T,children:"Incorrect username or password"}),(0,g.jsx)(i.x,{direction:"row",justify:"center",children:(0,g.jsx)(f.z,{plain:!0,label:"Login",type:"submit"})})]})})})]})})}},746:function(e,n,r){r.d(n,{x4:function(){return l},kS:function(){return f},ts:function(){return d},wt:function(){return h}});var t=r(5861),a=r(7757),u=r.n(a),c=r(4569),s=r.n(c),i=r(3708),o=r(9444),l=function(){var e=(0,t.Z)(u().mark((function e(n,r){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s().post("".concat(i.T5,"/auth/login"),{email:n,password:r});case 2:return(t=e.sent).data.accessToken&&localStorage.setItem("user",JSON.stringify(t.data)),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),p=function(){var e=(0,t.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s().post("".concat(i.T5,"/auth/verify"),null,{headers:(0,o.Z)()});case 3:if(e.sent.data.userId!==d().id){e.next=8;break}return e.abrupt("return",i.M);case 8:return e.abrupt("return",i.fs);case 9:e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",i.fs);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),f=function(){localStorage.removeItem("user")},d=function(){return JSON.parse(localStorage.getItem("user"))},h=function(){var e=(0,t.Z)(u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d()){e.next=13;break}return e.prev=1,e.next=4,p();case 4:return n=e.sent,e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",i.fs);case 11:e.next=14;break;case 13:return e.abrupt("return",i.fs);case 14:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},9444:function(e,n,r){var t=r(746);n.Z=function(){var e=(0,t.ts)();return e&&e.accessToken?{"x-access-token":e.accessToken}:{}}}}]);
//# sourceMappingURL=77.c0cab1db.chunk.js.map